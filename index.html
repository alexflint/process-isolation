<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Process-isolation by alexflint</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Process-isolation</h1>
        <p>Elegant process isolation in pure python</p>

        <p class="view"><a href="https://github.com/alexflint/process-isolation">View the Project on GitHub <small>alexflint/process-isolation</small></a></p>


        <ul>
          <li><a href="https://github.com/alexflint/process-isolation/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/alexflint/process-isolation/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/alexflint/process-isolation">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="process-isolation-in-python" class="anchor" href="#process-isolation-in-python"><span class="octicon octicon-link"></span></a>Process Isolation in Python</h1>

<p>Process isolation is a simple and elegant tool that lets you run
python modules in sub-processes.</p>

<pre><code>from process_isolation import import_isolated
sys = import_isolated('sys')
sys.stdout.write('Hello world\n')
</code></pre>

<p>A few things happened here:</p>

<ol>
<li>
<p>We imported the <code>process_isolation</code> module:</p>

<pre><code>from process_isolation import import_isolated
</code></pre>
</li>
<li>
<p>The process forked and the <code>sys</code> module was imported in the child process:</p>

<pre><code>sys = import_isolated('sys')
</code></pre>
</li>
<li>
<p>The parent process requested that the child process run <code>sys.stdout.write('Hello world\n')</code>:</p>

<pre><code>sys.stdout.write('Hello world\n')
</code></pre>
</li>
<li><p>The child process wrote <code>Hello world</code> to standard output.</p></li>
</ol><p>One reason tun run code in an isolated process is to debug code that
crashes at the operating system level with a segmentation fault or
other signal. Here is some dangerous code:</p>

<pre><code># buggy.py:

import types
def dragons_here():
    types.FunctionType(types.CodeType(0, 0, 1, 0, 'd\x00\x00S', (), (), (), '', '', 1, ''),{})()
</code></pre>

<p>Running this code causes a hard abort (not a regular python exception),
which makes it difficult to debug:</p>

<pre><code>&gt;&gt;&gt; import buggy
&gt;&gt;&gt; buggy.dragons_here()
Segmentation fault: 11
</code></pre>

<p>We can safely run this code inside an isolated process, and do
something when it crashes:</p>

<pre><code>from process_isolation import import_isolated, ProcessTerminationError
buggy = import_isolated('buggy')
try:
    buggy.dragons_here()
except ProcessTerminationError as ex:
    print 'There be dragons!'
</code></pre>

<h3>
<a name="using-process-isolation" class="anchor" href="#using-process-isolation"><span class="octicon octicon-link"></span></a>Using process isolation</h3>

<p><code>process_isolation</code> tries to be as transparent as possible. In many
cases it is possible to simply replace </p>

<pre><code>import X
</code></pre>

<p>with </p>

<pre><code>X = import_isolated('X')
</code></pre>

<p>and leave all other code unchanged. <code>process_isolation</code> shuttles data
back and forward between the main python interpreter and the forked
child process, using proxies on the client side in place of objects
that actually reside inside an isolated sub-process.</p>

<h3>
<a name="caveats" class="anchor" href="#caveats"><span class="octicon octicon-link"></span></a>Caveats</h3>

<h3>
<a name="why-process-isolation" class="anchor" href="#why-process-isolation"><span class="octicon octicon-link"></span></a>Why process isolation?</h3>

<h3>
<a name="more-sophisticated-examples" class="anchor" href="#more-sophisticated-examples"><span class="octicon octicon-link"></span></a>More sophisticated examples</h3>

<h3>
<a name="copying-objects-between-processes" class="anchor" href="#copying-objects-between-processes"><span class="octicon octicon-link"></span></a>Copying objects between processes</h3>

<h3>
<a name="under-the-hood" class="anchor" href="#under-the-hood"><span class="octicon octicon-link"></span></a>Under the hood</h3>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/alexflint">alexflint</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-36566659-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>